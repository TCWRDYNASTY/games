<!DOCTYPE html>
<html>
<head>
  <title>NFL Guess Who?</title>
  <style>
    body {
      font-family: Chalkduster;
      text-align: center;
      background-color: #1e3159; /* Dark blue background */
      color: white; /* Set default text color to white */
      margin: 0; /* Remove default body margin */
      padding-top: 20px; /* Add some padding at the top */
    }
    #game-container {
      width: 80%;
      margin: 20px auto;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 5px;
      position: relative; /* For absolute positioning of high scores */
      background-color: transparent;
      font-family: courier new;
      color: white; /* Set text color inside the container to black */
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); /* Add a subtle shadow */
    }
    #question-area {
      margin-bottom: 20px;
    }
    #guess-input {
      padding: 10px;
      margin-right: 10px;
      border: 1px solid #ddd;
      border-radius: 3px;
      font-family: sans-serif; /* Keep input default */
      color: black; /* Ensure text in input is black */
    }
    button {
      padding: 10px 20px;
      background-color: #4CAF50; /* Green button color */
      color: white;
      border: none;
      border-radius: 3px;
      cursor: pointer;
      font-size: 1em; /* Make the font a bit larger */
      font-family: times;
      transition: background-color 0.3s ease; /* Add a smooth hover transition */
    }
    button:hover {
      background-color: #45a049; /* Darker green on hover */
    }
    #result-area {
      margin-top: 20px;
      font-weight: bold;
    }
    #timer {
      font-size: 1.5em;
      margin-bottom: 10px;
      font-family: impact;
      color: red;
      font-weight: bold;
    }
    #high-scores-container {
      position: absolute;
      
      right: 20px;
      background-color: rgba(255, 255, 255, 0.8);
      padding-left: 25px;
      padding-right: 25px;
      border: 1px solid #ccc;
      border-radius: 5px;
      text-align: center;
      max-height: 200px;
      overflow-y: auto;
      color: black; /* Set text color for high scores */
      font-family: sans-serif; /* Keep high scores readable */
    }
    #high-scores-container h2 {
      margin-top: 0;
      font-size: 1.2em;
    }
    #high-scores-list {
      list-style-type: none;
      padding: 0;
      margin: 0;
    }
    #high-scores-list li {
      padding: 5px 0;
      border-bottom: 1px dotted #eee;
    }
    #high-scores-list li:last-child {
      border-bottom: none;
    }
  </style>
</head>
<body>

 <h1>NFL Guess Who?</h1>

<div id="high-scores-container" style="display: none;">
    <h2 style="text-decoration: underline;">Top Scores</h2>
    <ol id="high-scores-list"></ol>
  </div>

<img src="XO.jpeg" alt="Kenny" class="center" style="width: 500px;"/ style="align: center;">
<div id="game-container">
  

 

  <div id="name-entry">
    <label for="player-name">Enter Your Name:</label>
    <input type="text" id="player-name">
    <button id="start-button">Start Game</button>
  </div>

  <div id="game-area" style="display: none;">
    <div id="timer">Time Left: <span id="time-remaining">5:00</span></div>
    <div id="question-area">
      <p id="question-text"></p>
      <ul id="clues-list">
        <li id="clue1" style="display: none;"></li>
        <li id="clue2" style="display: none;"></li>
        <li id="clue3" style="display: none;"></li>
        <li id="clue4" style="display: none;"></li>
      </ul>
    </div>
    <div id="guess-area">
      <input type="text" id="guess-input" placeholder="Your Guess">
      <button id="submit-button">Submit Guess</button>
    </div>
    <div id="result-area">
      <p id="guess-result"></p>
      <p id="score"></p>
      <p id="wrong-guesses"></p>
    </div>
  </div>

  <div id="game-over" style="display: none;">
    <h2>Game Over!</h2>
    <p id="final-score"></p>
    <p id="game-over-message"></p>
    <button id="save-score-button" style="display: none;">Save Score</button>
    <button id="restart-button">Play Again?</button>
  </div>
</div>

<script>
const questions = [
  {
    question: "Who am I?",
    clues: [
      "I played quarterback.",
      "I won a Super Bowl MVP award during this time frame.",
      "My jersey number was 12.",
      "I played for the Green Bay Packers."
    ],
    answer: "Aaron Rodgers"
  },
  {
    question: "Who am I?",
    clues: [
      "I am a tight end.",
      "I played for the Kansas City Chiefs and am known for my connection with my quarterback.",
      "My jersey number is 87.",
      "My girlfriend is a famous singer."
    ],
    answer: "Travis Kelce"
  },
  {
    question: "Who am I?",
    clues: [
      "I am a wide receiver.",
      "I hold the NFL record for most receiving yards in a season.",
      "My jersey number was 81.",
      "I played for the Detroit Lions."
    ],
    answer: "Calvin Johnson"
  },
  {
    question: "Who am I?",
    clues: [
      "I played running back.",
      "I have a 'Beast Mode' nickname.",
      "My jersey number was 24.",
      "I played for the Seattle Seahawks."
    ],
    answer: "Marshawn Lynch"
  },
  {
    question: "Who am I?",
    clues: [
      "I am a quarterback.",
      "I have won multiple Super Bowl championships with the New England Patriots.",
      "My jersey number was 12.",
      "I am considered one of the greatest quarterbacks of all time."
    ],
    answer: "Tom Brady"
  },
  {
    question: "Who am I?",
    clues: [
      "I am a defensive end.",
      "I am known for my pass-rushing abilities and 'sack dances'.",
      "My jersey number was 99.",
      "I played for the Houston Texans and Arizona Cardinals."
    ],
    answer: "J.J. Watt"
  },
  {
    question: "Who am I?",
    clues: [
      "I am a wide receiver.",
      "I was known for my incredible speed and deep-threat ability.",
      "My jersey number was 10.",
      "I played for the Philadelphia Eagles."
    ],
    answer: "DeSean Jackson"
  },
  {
    question: "Who am I?",
    clues: [
      "I played middle linebacker.",
      "I was the leader of the 'Monsters of the Midway' defense.",
      "My jersey number was 54.",
      "I played my entire career for the Chicago Bears."
    ],
    answer: "Brian Urlacher"
  },
  {
    question: "Who am I?",
    clues: [
      "I am a quarterback.",
      "I won a Super Bowl with the New Orleans Saints.",
      "My jersey number is 9.",
      "I have a distinctive birthmark on my face."
    ],
    answer: "Drew Brees"
  },
  {
    question: "Who am I?",
    clues: [
      "I am a cornerback.",
      "I was known as 'Prime Time'.",
      "My jersey numbers included 21 and 2.",
      "I played for multiple teams, including the Atlanta Falcons and Dallas Cowboys."
    ],
    answer: "Deion Sanders"
  }
];

  const supabaseUrl = 'https://odimpbkwklwenmrszaia.supabase.co';
  const supabaseApiKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9kaW1wYmt3a2x3ZW5tcnN6YWlhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU3MTY0MDUsImV4cCI6MjA2MTI5MjQwNX0.K2euAW8f9H5GLBHrVJCjMa6ubm_qLf3zUR_cAfPXylM';
  const highScoresTableName = 'scores'; // Correct table name

  let currentQuestionIndex = 0;
  let score = 0;
  let wrongGuesses = 0;
  let clueIndex = 0;
  let playerName = "";
  const maxWrongGuesses = 5;
  const gameDuration = 5 * 60;
  let timeLeft = gameDuration;
  let timerInterval;
  let gameStarted = false;

  const highScoresContainer = document.getElementById("high-scores-container");
  const highScoresList = document.getElementById("high-scores-list");
  const nameEntryDiv = document.getElementById("name-entry");
  const gameAreaDiv = document.getElementById("game-area");
  const gameOverDiv = document.getElementById("game-over");
  const playerNameInput = document.getElementById("player-name");
  const startButton = document.getElementById("start-button");
  const questionText = document.getElementById("question-text");
  const cluesList = document.getElementById("clues-list");
  const clueElements = [
    document.getElementById("clue1"),
    document.getElementById("clue2"),
    document.getElementById("clue3"),
    document.getElementById("clue4")
  ];
  const guessInput = document.getElementById("guess-input");
  const submitButton = document.getElementById("submit-button");
  const resultArea = document.getElementById("result-area");
  const guessResultText = document.getElementById("guess-result");
  const scoreText = document.getElementById("score");
  const wrongGuessesText = document.getElementById("wrong-guesses");
  const finalScoreText = document.getElementById("final-score");
  const restartButton = document.getElementById("restart-button");
  const timeRemainingDisplay = document.getElementById("time-remaining");
  const gameOverMessage = document.getElementById("game-over-message");
  const saveScoreButton = document.getElementById("save-score-button");

  async function fetchHighScores() {
    try {
      const response = await fetch(`${supabaseUrl}/rest/v1/${highScoresTableName}?order=score.desc&limit=10`, {
        headers: {
          'apikey': supabaseApiKey,
          'Authorization': `Bearer ${supabaseApiKey}`,
        },
      });
      if (response.ok) {
        const data = await response.json();
        displayHighScores(data);
        highScoresContainer.style.display = "block";
      } else {
        const errorText = await response.text();
        console.error('Failed to fetch high scores:', response.status, errorText);
        highScoresContainer.style.display = "none";
      }
    } catch (error) {
      console.error('Error fetching high scores (catch):', error);
      highScoresContainer.style.display = "none";
    }
  }

  function displayHighScores(scores) {
    highScoresList.innerHTML = '';
    scores.forEach((entry, index) => {
      const listItem = document.createElement('li');
      listItem.textContent = `${index + 1}. ${entry.name}: ${entry.score}`;
      highScoresList.appendChild(listItem);
    });
  }

  async function saveHighScore() {
    if (playerName && score > 0) {
      try {
        const response = await fetch(`${supabaseUrl}/rest/v1/${highScoresTableName}`, { // Corrected URL
          method: 'POST',
          headers: {
            'apikey': supabaseApiKey,
            'Authorization': `Bearer ${supabaseApiKey}`,
            'Content-Type': 'application/json',
            'Prefer': 'return=minimal', // Don't need the returned data
          },
          body: JSON.stringify({ name: playerName, score: score }),
        });
        if (response.ok) {
          console.log('Score saved successfully to scores!');
          saveScoreButton.style.display = "none";
          fetchHighScores(); // Refresh the high scores
        } else {
          const errorText = await response.text();
          console.error('Failed to save score to scores:', response.status, errorText);
        }
      } catch (error) {
        console.error('Error saving score to scores:', error);
      }
    }
  }

  function startGame() {
    playerName = playerNameInput.value.trim();
    if (playerName) {
      nameEntryDiv.style.display = "none";
      gameAreaDiv.style.display = "block";
      score = 0;
      wrongGuesses = 0;
      currentQuestionIndex = 0;
      timeLeft = gameDuration; // Reset the timer
      updateTimerDisplay();
      loadQuestion();
      updateScoreDisplay();
      updateWrongGuessesDisplay();
      startTimer(); // Start the timer when the game begins
      gameStarted = true;
      fetchHighScores();
    } else {
      alert("Please enter your name to start the game.");
    }
  }

  function startTimer() {
    timerInterval = setInterval(() => {
      timeLeft--;
      updateTimerDisplay();
      if (timeLeft <= 0) {
        clearInterval(timerInterval);
        endGame("Time's up!");
      }
    }, 1000);
  }

  function updateTimerDisplay() {
    const minutes = Math.floor(timeLeft / 60);
    const seconds = timeLeft % 60;
    timeRemainingDisplay.textContent = `${String(minutes).padStart(1, '0')}:${String(seconds).padStart(2, '0')}`;
  }

  function loadQuestion() {
    clueIndex = 0;
    const currentQuestion = questions[currentQuestionIndex];
    questionText.textContent = currentQuestion.question;
    clueElements.forEach(clue => clue.style.display = "none");
    showNextClue();
    guessInput.value = "";
    guessResultText.textContent = "";
    submitButton.disabled = false;
  }

  function showNextClue() {
    if (clueIndex < questions[currentQuestionIndex].clues.length) {
      clueElements[clueIndex].textContent = questions[currentQuestionIndex].clues[clueIndex];
      clueElements[clueIndex].style.display = "block";
      clueIndex++;
    }
  }

  function submitGuess() {
    const userAnswer = guessInput.value.trim();
    const correctAnswer = questions[currentQuestionIndex].answer;

    if (userAnswer.toLowerCase() === correctAnswer.toLowerCase()) {
      let points = 0;
      switch (clueIndex) {
        case 1:
          points = 4;
          break;
        case 2:
          points = 3;
          break;
        case 3:
          points = 2;
          break;
        case 4:
          points = 1;
          break;
        default:
          points = 0;
      }
      score += points;
      guessResultText.textContent = `Correct! You earned ${points} points.`;
      submitButton.disabled = true;
      setTimeout(nextQuestion, 1500);
    } else {
      guessResultText.textContent = "Incorrect. Try again with the next clue.";
      wrongGuesses++;
      updateWrongGuessesDisplay();
      if (wrongGuesses >= maxWrongGuesses) {
        endGame("Too many wrong guesses!");
      } else {
        showNextClue();
        if (clueIndex > questions[currentQuestionIndex].clues.length) {
          guessResultText.textContent = `The correct answer was: ${correctAnswer}`;
          submitButton.disabled = true;
          setTimeout(nextQuestion, 2000);
        }
      }
    }
    updateScoreDisplay();
  }

  function nextQuestion() {
    currentQuestionIndex++;
    if (currentQuestionIndex < questions.length) {
      loadQuestion();
    } else {
      endGame("You finished all the questions!");
    }
  }

  function endGame(gameOverReason) {
    clearInterval(timerInterval); // Stop the timer
    gameAreaDiv.style.display = "none";
    gameOverDiv.style.display = "block";
    finalScoreText.textContent = `Your final score is: ${score}`;
    gameOverMessage.textContent = gameOverReason;
    if (gameStarted && score > 0 && gameOverReason !== "Time's up!") {
      saveScoreButton.style.display = "block";
    } else {
      saveScoreButton.style.display = "none";
    }
    gameStarted = false;
  }

  function restartGame() {
    gameOverDiv.style.display = "none";
    nameEntryDiv.style.display = "block";
    playerNameInput.value = "";
    guessResultText.textContent = "";
    scoreText.textContent = "";
    wrongGuesses = 0;
    updateWrongGuessesDisplay();
    timeLeft = gameDuration;
    updateTimerDisplay();
    gameStarted = false;
  }

  startButton.addEventListener("click", startGame);
  playerNameInput.addEventListener("keypress", function(event) {
    if (event.key === "Enter") {
      startButton.click();
    }
  });

  submitButton.addEventListener("click", submitGuess);
  guessInput.addEventListener("keypress", function(event) {
    if (event.key === "Enter") {
      submitButton.click();
    }
  });

  restartButton.addEventListener("click", restartGame);
  saveScoreButton.addEventListener("click", saveHighScore);

  function updateScoreDisplay() {
    scoreText.textContent = `Score: ${score}`;
  }

  function updateWrongGuessesDisplay() {
    wrongGuessesText.textContent = `Wrong Guesses: ${wrongGuesses} / ${maxWrongGuesses}`;
  }

  // Fetch initial high scores when the page loads
  fetchHighScores();
</script>
</body>
</html>
